<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: popup_preferences.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: popup_preferences.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>//called when the preferences page is displayed (see popup_toggle_pages.js)
/** Get the values of the inputs in the Default Settings of Popup, and set the DefaultPreferences for the relevant profile in browser.storage.local accordingly*/
function displayCurrentDefaultPreferences(){
    browser.storage.local.get(["preferences", "profiles"]).then(result => {
        const prefs = result.preferences;
        let activeProfile = result.profiles.activeProfile;

        let activeProfileIndex = prefs.findIndex(el => el.id == activeProfile);

        document.getElementById("defaults-profile_name").value = prefs[activeProfileIndex].profile;
        document.getElementById("defaults-constant").value = prefs[activeProfileIndex].constant;
        document.getElementById("defaults-lower_case-chckbx").checked = prefs[activeProfileIndex].encoding.lower;
        document.getElementById("defaults-upper_case-chckbx").checked = prefs[activeProfileIndex].encoding.upper;
        document.getElementById("defaults-numbers-chckbx").checked = prefs[activeProfileIndex].encoding.num;
        document.getElementById("defaults-special_chars-chckbx").checked = prefs[activeProfileIndex].encoding.special;

        document.getElementById("defaults-pwd_length").value = prefs[activeProfileIndex].length;
        document.getElementById("defaults-store_preferences-chckbx").checked = prefs[activeProfileIndex].save_preferences;
        document.getElementById("defaults-insert_pwd_into_content-chckbx").checked = prefs[activeProfileIndex].inject_into_content;
        document.getElementById("defaults-copy_pwd_to_clipboard-chckbx").checked = prefs[activeProfileIndex].copy_to_clipboard;
    });
}

/** Get DefaultPreferences for the relevant profile from browser.storage.local and set the inputs in the Default Settings in popup*/
function updatePreferencesHandler(event){
    const element = event.target;

    //alternatively, read all of their values at once and update them at once instead of one by one
    browser.storage.local.get(["preferences", "profiles"])
        .then(result => {
            let prefs = result.preferences;
            let activeProfile = result.profiles.activeProfile;

            let activeProfileIndex = prefs.findIndex(el => el.id == activeProfile);

            prefs[activeProfileIndex].profile = document.getElementById("defaults-profile_name").value;
            prefs[activeProfileIndex].constant = document.getElementById("defaults-constant").value;
            prefs[activeProfileIndex].encoding.lower = document.getElementById("defaults-lower_case-chckbx").checked;
            prefs[activeProfileIndex].encoding.upper = document.getElementById("defaults-upper_case-chckbx").checked;
            prefs[activeProfileIndex].encoding.num = document.getElementById("defaults-numbers-chckbx").checked;
            prefs[activeProfileIndex].encoding.special = document.getElementById("defaults-special_chars-chckbx").checked;
            prefs[activeProfileIndex].length = document.getElementById("defaults-pwd_length").value;
            prefs[activeProfileIndex].save_preferences = document.getElementById("defaults-store_preferences-chckbx").checked;
            prefs[activeProfileIndex].inject_into_content = document.getElementById("defaults-insert_pwd_into_content-chckbx").checked;
            prefs[activeProfileIndex].copy_to_clipboard = document.getElementById("defaults-copy_pwd_to_clipboard-chckbx").checked;

            browser.storage.local.set({preferences: prefs})
                .catch(error => console.log(error));
        });

    // browser.storage.local.get("preferences")
    //     .then(result => {
    //         const preferences = result.preferences;
    //
    //         switch (element.name){
    //             case "lower-case": preferences.encoding.lower = element.checked; break;
    //             case "upper-case": preferences.encoding.upper = element.checked; break;
    //             case "numbers": preferences.encoding.num = element.checked; break;
    //             case "special-chars": preferences.encoding.special = element.checked; break;
    //             case "pwd-length": preferences.length = element.value; break;
    //             case "store-preferences": preferences.save_preferences = element.checked; break;
    //         }
    //
    //         browser.storage.local.set({preferences: preferences})
    //             .catch(error => console.log(error));
    //     });

}

document.querySelectorAll(".defaults-input").forEach(el => {
    el.addEventListener("change", updatePreferencesHandler);
});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addProfile">addProfile</a></li><li><a href="global.html#allPreferencesArray">allPreferencesArray</a></li><li><a href="global.html#allProfilesDefaults">allProfilesDefaults</a></li><li><a href="global.html#changeActiveProfileHandler">changeActiveProfileHandler</a></li><li><a href="global.html#changeInServiceNameHandler">changeInServiceNameHandler</a></li><li><a href="global.html#changePasswordSettings">changePasswordSettings</a></li><li><a href="global.html#changeProfileName">changeProfileName</a></li><li><a href="global.html#changeServiceName">changeServiceName</a></li><li><a href="global.html#CHARACTER_SETS">CHARACTER_SETS</a></li><li><a href="global.html#copyGeneratePwdToClipboard">copyGeneratePwdToClipboard</a></li><li><a href="global.html#decode">decode</a></li><li><a href="global.html#decrypt">decrypt</a></li><li><a href="global.html#deleteAllStoredPreferences">deleteAllStoredPreferences</a></li><li><a href="global.html#deleteDomain">deleteDomain</a></li><li><a href="global.html#deleteEntryForProfileFromDB">deleteEntryForProfileFromDB</a></li><li><a href="global.html#deleteProfile">deleteProfile</a></li><li><a href="global.html#deleteService">deleteService</a></li><li><a href="global.html#displayCurrentDefaultPreferences">displayCurrentDefaultPreferences</a></li><li><a href="global.html#displayError">displayError</a></li><li><a href="global.html#displayPotentialChangeInStorageWarning">displayPotentialChangeInStorageWarning</a></li><li><a href="global.html#displayPreferences">displayPreferences</a></li><li><a href="global.html#displayProfiles">displayProfiles</a></li><li><a href="global.html#displayProfileSelect">displayProfileSelect</a></li><li><a href="global.html#displayUIDetails">displayUIDetails</a></li><li><a href="global.html#downloadFromGDrive">downloadFromGDrive</a></li><li><a href="global.html#ejectDomain">ejectDomain</a></li><li><a href="global.html#encode">encode</a></li><li><a href="global.html#encrypt">encrypt</a></li><li><a href="global.html#encryptionPassword">encryptionPassword</a></li><li><a href="global.html#encryptionPasswordInputHandler">encryptionPasswordInputHandler</a></li><li><a href="global.html#exportPreferences">exportPreferences</a></li><li><a href="global.html#extractAccessToken">extractAccessToken</a></li><li><a href="global.html#FILE_NAME">FILE_NAME</a></li><li><a href="global.html#fillProfileSelect">fillProfileSelect</a></li><li><a href="global.html#fillUIWithPreferences">fillUIWithPreferences</a></li><li><a href="global.html#generatePassword">generatePassword</a></li><li><a href="global.html#generatePasswordHandler">generatePasswordHandler</a></li><li><a href="global.html#get_main_domain_or_ip">get_main_domain_or_ip</a></li><li><a href="global.html#get_url_without_protocol_or_path">get_url_without_protocol_or_path</a></li><li><a href="global.html#getAccessToken">getAccessToken</a></li><li><a href="global.html#getAllIndiPrefsForActiveProfile">getAllIndiPrefsForActiveProfile</a></li><li><a href="global.html#getAllPrefsForProfileFromDB">getAllPrefsForProfileFromDB</a></li><li><a href="global.html#getAllServices">getAllServices</a></li><li><a href="global.html#getDefaultPreferences">getDefaultPreferences</a></li><li><a href="global.html#getExportData">getExportData</a></li><li><a href="global.html#getFileFromDrive">getFileFromDrive</a></li><li><a href="global.html#getKey">getKey</a></li><li><a href="global.html#getKeyMaterial">getKeyMaterial</a></li><li><a href="global.html#getPrefForDomain">getPrefForDomain</a></li><li><a href="global.html#getPrefForService">getPrefForService</a></li><li><a href="global.html#HASH_N_TIMES">HASH_N_TIMES</a></li><li><a href="global.html#importSettings">importSettings</a></li><li><a href="global.html#indiPrefDB">indiPrefDB</a></li><li><a href="global.html#indiPrefs">indiPrefs</a></li><li><a href="global.html#initDefaultPreferences">initDefaultPreferences</a></li><li><a href="global.html#initExtension">initExtension</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#initIndiPrefDB">initIndiPrefDB</a></li><li><a href="global.html#initPublicSuffDataStorage">initPublicSuffDataStorage</a></li><li><a href="global.html#insertDefaultSettings">insertDefaultSettings</a></li><li><a href="global.html#isProfileNameValid">isProfileNameValid</a></li><li><a href="global.html#isStored">isStored</a></li><li><a href="global.html#isValidImportedJSON">isValidImportedJSON</a></li><li><a href="global.html#launchAuthFlow">launchAuthFlow</a></li><li><a href="global.html#listFiles">listFiles</a></li><li><a href="global.html#logError">logError</a></li><li><a href="global.html#openIndiPrefDB">openIndiPrefDB</a></li><li><a href="global.html#potentialUpdateOfPreferencesHandler">potentialUpdateOfPreferencesHandler</a></li><li><a href="global.html#preferenceForService">preferenceForService</a></li><li><a href="global.html#preferencesDefault">preferencesDefault</a></li><li><a href="global.html#profileChangeHandler">profileChangeHandler</a></li><li><a href="global.html#putFileToDrive">putFileToDrive</a></li><li><a href="global.html#putIndiPrefsForProfileInDB">putIndiPrefsForProfileInDB</a></li><li><a href="global.html#refillIndiPrefsOfProfileInDB">refillIndiPrefsOfProfileInDB</a></li><li><a href="global.html#saveModifiedTable">saveModifiedTable</a></li><li><a href="global.html#setPasswordPreferencesInHomepageUI">setPasswordPreferencesInHomepageUI</a></li><li><a href="global.html#showPopupAbout">showPopupAbout</a></li><li><a href="global.html#showPopupDefaults">showPopupDefaults</a></li><li><a href="global.html#showPopupHome">showPopupHome</a></li><li><a href="global.html#showQRCode">showQRCode</a></li><li><a href="global.html#sortAllPreferencesArray">sortAllPreferencesArray</a></li><li><a href="global.html#storePrefInDB">storePrefInDB</a></li><li><a href="global.html#toggleAllDomainsRows">toggleAllDomainsRows</a></li><li><a href="global.html#toggleDomainsRow">toggleDomainsRow</a></li><li><a href="global.html#toggleEncryptProfile">toggleEncryptProfile</a></li><li><a href="global.html#updatePreferencesHandler">updatePreferencesHandler</a></li><li><a href="global.html#uploadToGDrive">uploadToGDrive</a></li><li><a href="global.html#validate">validate</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Tue Jun 15 2021 04:39:48 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
